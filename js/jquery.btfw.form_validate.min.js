!function(_,n,e,i){"use strict";var s="formValidate",a=s+".settings";_.fn[s]=function(e){var E,t={init:function(e){return E=_.extend({},_.fn[s].defaults,e),this.each(function(){var r=_(this);r.data(a,E);_.each(["submit"],function(){var e=E[this];"string"==typeof e?r.on(this+"."+s,function(){return r[s](e)}):_.isFunction(e)&&r.on(this+"."+s,e)})})},destroy:function(){return this.each(function(){var e=_(this);_.each(["submit"],function(){e.off(this+"."+s)})})},dispError:function(e){E=_(this).data(a);var s=this;_.each(e,function(e,r){t.setError.apply(s,[r.name,r.message])}),0<e.length&&E.focusError&&t.focusError.apply(this,[e[0].name])},focusError:function(e){E=_(this).data(a);var r=_(this).find("*[name='"+e+"']");_(r).focus();var s=_(r).offset().top-_(n).innerHeight()/2;s<0&&(s=0),_("html,body").animate({scrollTop:s},E.focusErrorSpeed)},clearError:function(e){return E=_(this).data(a),_.isFunction(E.clearError)?E.clearError.apply(this,[e]):"tb2"===E.errorType?t.clearErrorTb2.apply(this,[e]):t.clearErrorBootstrap.apply(this,[e]),this},setError:function(e,r){return E=_(this).data(a),_.isFunction(E.setError)?E.setError.apply(this,[e,r]):"tb2"===E.errorType?t.setErrorTb2.apply(this,[e,r]):t.setErrorBootstrap.apply(this,[e,r]),this},clearErrorBootstrap:function(e){if(e){var r=_(this).find("*[name='"+e+"']");_(r).closest(".form-group").removeClass("has-error").find(".error_message").remove()}else _(this).find(".form-group").removeClass("has-error").find(".error_message").remove();return this},setErrorBootstrap:function(e,r){var s=_(this).find("*[name='"+e+"']"),t='<span class="help-block error_message">'+r+"</span>";if(_(s).closest(".form-group").addClass("has-error"),"radio"!==s.attr("type")&&"checkbox"!==s.attr("type")){var n=_(s).closest(".input-group");0!==_(n).length?_(n).after(t):_(s).filter(":last").after(t)}else _(s).filter(":last").parent().after(t);return this},clearErrorTb2:function(e){if(e){var r=_(this).find("*[name='"+e+"']");_(r).closest(".control-group").removeClass("error").find(".error_message").remove()}else _(this).find(".control-group").removeClass("error").find(".error_message").remove();return this},setErrorTb2:function(e,r){var s=_(this).find("*[name='"+e+"']");return _(s).closest(".control-group").addClass("error"),_(s).closest(".controls").append('<div class="help-block error_message">'+r+"</div>"),this},validate:function(e){E=_.extend(_(this).data(a),e),t.clearError.apply(this);var r=!0,s=t.getValidateResult.apply(this,[E]);return 0<s.length&&(t.dispError.apply(this,[s]),r=!1),_.isFunction(E.result)&&(r=E.result.apply(this,[r,s])),r},validate_alert:function(e){E=_.extend(_(this).data(a),e);var r=!0,s=t.getValidateResult.apply(this,[E]);return 0<s.length&&(alert(E.messages.VALIDATE_ERROR+"\n"+c.join(s)),E.focusError&&t.focusError.apply(this,[s[0].name]),r=!1),_.isFunction(E.result)&&(r=E.result.apply(this,[r,s])),r},getValidateResult:function(e){var l=this;E=_.extend(_(this).data(a),e);var o=[],r=E.fields;return _.isArray(r)&&_.each(r,function(e,a){if(!a.rules)return!0;var r=a.rules;_.isArray(r)||(r=[r]);var i=_(l).find("*[name='"+a.name+"']"),u=c.existsValue(i);return _.each(r,function(e,r){var s,t,n=[];if(_.isArray(r)){if(!r[0])return;r[1]&&(t=r[1],_.isArray(t)||(t=[t])),r=r[0]}else if("object"==typeof r){if(!r.rule)return;r.params&&(t=r.params,_.isArray(t)||(t=[t])),r=r.rule}else if("string"==typeof r)if((t=r.split(":",2))[0]&&(r=t[0]),t[1]){try{t=JSON.parse(t[1])}catch(e){t=t[1].split(",")}_.isArray(t)||(t=[t])}else t=[];_.isFunction(r)?(s=r.apply(l,[a,i,t,E]),c.pushErrors(n,a,s)):"string"==typeof r&&(u?m[r]&&(s=m[r].apply(l,[a,i,t,E]),c.pushErrors(n,a,s)):"required"===r?c.pushErrors(n,a,E.messages.REQUIRED):f[r]&&(s=f[r].apply(l,[a,i,t,E]),c.pushErrors(n,a,s))),0<n.length&&(o=o.concat(n))}),!0}),o}},f={zip_ex:function(e,r,s,t){var n=_(this).find("*[name='"+e.name+t.zip_suffix+"']");return!r||!c.getValue(r)||n&&n.val()?null:t.messages.INSUFFICIENT},ymd:function(e,r,s){var t=[],n=null,a=null,i=null,u=!1,l=!1,o=!1,f=_(this).find("*[name='"+e.name+E.ymd_suffix_y+"']"),m=_(this).find("*[name='"+e.name+E.ymd_suffix_m+"']"),g=_(this).find("*[name='"+e.name+E.ymd_suffix_d+"']");return f&&""!==f.val()&&(u=!0,n=f.val()),m&&""!==m.val()&&(l=!0,a=m.val()),g&&""!==g.val()&&(o=!0,i=g.val()),"required"===s[0]?(u||t.push(c.format(E.messages.REQUIRED_PART,E.messages.DATE_PART_Y)),l||t.push(c.format(E.messages.REQUIRED_PART,E.messages.DATE_PART_M)),o||t.push(c.format(E.messages.REQUIRED_PART,E.messages.DATE_PART_D))):!(u||l||o)||u&&l&&o||(u||t.push(c.format(E.messages.INSUFFICIENT_PART,E.messages.DATE_PART_Y)),l||t.push(c.format(E.messages.INSUFFICIENT_PART,E.messages.DATE_PART_M)),o||t.push(c.format(E.messages.INSUFFICIENT_PART,E.messages.DATE_PART_D))),c._isInteger(n)||t.push(c.format(E.messages.INTEGER_PART,E.messages.DATE_PART_Y)),c._isInteger(a)||t.push(c.format(E.messages.INTEGER_PART,E.messages.DATE_PART_M)),c._isInteger(i)||t.push(c.format(E.messages.INTEGER_PART,E.messages.DATE_PART_D)),0!==t.length||c._isDate(n,a,i)||t.push(c.format(E.messages.DATE_INVALID)),t}},m={confirm:function(e,r,s){var t=_(this).find("*[name='"+e.name+E.confirm_suffix+"']");return r&&t&&c.getValue(r)===t.val()?null:c.format(E.messages.CONFIRM,e.d_name?e.d_name:E.messages.CONFIRM_FIELD)},email:function(e,r){var s=c.getValue(r);if(s){var t=c._isEmailEx(s);if(""!==t)return t}return null},zenkaku:function(e,r){return c._isZenkaku(c.getValue(r))?null:E.messages.ZENKAKU},hankaku:function(e,r){return c._isHankaku(c.getValue(r))?null:E.messages.HANKAKU},zen_katakana:function(e,r){return c._isAllkana(c.getValue(r))?null:E.messages.ZEN_KANA},hiragana:function(e,r){return c._isAllHiragana(c.getValue(r))?null:E.messages.HIRAGANA},tel:function(e,r){return c._isTel(c.getValue(r))?null:E.messages.TEL},minlength:function(e,r,s){var t=Number(s[0]);return c.getValue(r).length<t?c.format(E.messages.MIN_LENGTH,t):null},maxlength:function(e,r,s){var t=Number(s[0]);return t<c.getValue(r).length?c.format(E.messages.MAX_LENGTH,t):null},numeric:function(e,r){var s=c.getValue(r);return _.isNumeric(s)&&-1===s.indexOf(" ")?null:E.messages.NUMERICAL_VALUE},number:function(e,r){return m.numeric.apply(this,[e,r])},numlength:function(e,r,s){var t=c.getValue(r),n=s[0],a=s[0];return s[1]&&(n+=","+s[1],a+="～"+s[1]),new RegExp("^\\d{"+n+"}$").test(t)?null:c.format(E.messages.NUM_LENGTH,a)},min:function(e,r,s){var t=c.getValue(r);if(!c._isInteger(t))return E.messages.INTEGER;var n=Number(s[0]);return t<n?c.format(E.messages.MIN,n):null},max:function(e,r,s){var t=c.getValue(r);if(!c._isInteger(t))return E.messages.INTEGER;var n=Number(s[0]);return n<t?c.format(E.messages.MIN,n):null},range:function(e,r,s){var t=c.getValue(r);if(!c._isInteger(t))return E.messages.INTEGER;var n=Number(s[0]),a=Number(s[1]);return t<n||a<t?c.format(E.messages.RANGE,n,a):null},date:function(e,r){var s=c.getValue(r),t=new RegExp("^((\\d{1,4})[/-](\\d{1,2})[/-](\\d{1,2}))$","g");return s.match(t)?c._isDate(RegExp.$2,RegExp.$3,RegExp.$4)?null:E.messages.DATE_INVALID:E.messages.DATE},datetime:function(e,r){var s=c.getValue(r),t=new RegExp("^((\\d{1,4})[/-](\\d{1,2})[/-](\\d{1,2}))( ((\\d{1,2}):(\\d{1,2})(:(\\d{1,2}))?))?$","g");return s.match(t)?c._isDate(RegExp.$2,RegExp.$3,RegExp.$4)?RegExp.$6&&!c._isTime(RegExp.$7,RegExp.$8,RegExp.$10)?E.messages.TIME_INVALID:null:E.messages.DATE_INVALID:E.messages.DATETIME},date_ex:function(e,r){var s=c.getValue(r),t=new RegExp("^(\\d{1,4})([/-](\\d{1,2})([/-](\\d{1,2}))?)?$");if(!s.match(t))return E.messages.DATE_EX;var n=RegExp.$1,a=RegExp.$3?RegExp.$3:1,i=RegExp.$5?RegExp.$5:1;return c._isDate(n,a,i)?null:E.messages.DATE_INVALID},time:function(e,r,s){var t,n=c.getValue(r);if("hm"===s[0]){if(t=new RegExp("^(\\d{1,2}):(\\d{1,2})$","g"),!n.match(t))return E.messages.TIME_HM;if(!c._isTime(RegExp.$1,RegExp.$2,0))return E.messages.TIME_INVALID}else{if(t=new RegExp("^(\\d{1,2}):(\\d{1,2}):(\\d{1,2})$","g"),!n.match(t))return E.messages.TIME;if(!c._isTime(RegExp.$1,RegExp.$2,RegExp.$3))return E.messages.TIME_INVALID}return null},zip:function(e,r){var s=c.getValue(r),t=new RegExp("^\\d{1,3}-\\d{1,4}$","g");return s.match(t)?null:E.messages.ZIP},checkbox:function(e,r,s){var t,n=r.filter(":checked").length,a=Number(s[0]);if(2<=s.length){if(t=Number(s[1]),n<a||t<n)return c.format(E.messages.CHECKBOX_RANGE,a,t)}else if(n<a)return c.format(E.messages.CHECKBOX_MIN,a)},regexp:function(e,r,s){var t,n,a=c.getValue(r);_.isArray(s)||(s=[s]);try{if(n="string"==typeof s[0]?(t=new RegExp(s[0],s[1]?s[1]:i),s[2]):(t=s[0],s[1]),!t.test(a))return n||E.messages.REGEXP_INVALID_VALUE}catch(e){return E.messages.REGEXP_INVALID_PARAM}return null}},c={existsValue:function(e){return!!e&&("checkbox"===e.attr("type")?0<e.filter(":checked").length:!!c.getValue(e))},getValue:function(e){var r,s=e.attr("type");return"radio"===s?r=e.filter(":checked").val():"checkbox"!==s?r=e.val():(r=[],e.filter(":checked").each(function(){r.push(_(this).val())})),r},pushErrors:function(s,t,e){return"string"==typeof e&&e?s.push({name:t.name,d_name:t.d_name,message:e}):_.isArray(e)&&_.each(e,function(e,r){s.push({name:t.name,d_name:t.d_name,message:r})}),s},_isHankaku:function(e){return!/[^\x20-\x7E]/.test(e)},_isZenkaku:function(e){return!/[\w\-\.]/.test(e)},_isTel:function(e){return!/[^0-9\-\(\)]/.test(e)},_isInteger:function(e){return/^(-\d+|\d*)$/.test(""+e)&&!isNaN(e)},_isDate:function(e,r,s){if(e<1900||9999<e)return!1;if(r<1||12<r)return!1;if(s<1)return!1;var t=[31,28,31,30,31,30,31,31,30,31,30,31];return(e%4==0&&e%100!=0||e%400==0)&&(t[1]=29),!(t[r-1]<s)},_isTime:function(e,r,s){return!(e<0||24<=e)&&(!(r<0||60<=r)&&!(null!==s&&(s<0||60<=s)))},_isAllkana:function(e){for(var r=0;r<e.length;r++)if((e.charAt(r)<"ァ"||"ヶ"<e.charAt(r))&&"ー"!==e.charAt(r)&&" "!==e.charAt(r)&&"　"!==e.charAt(r))return!1;return!0},_isAllHiragana:function(e){for(var r=0;r<e.length;r++)if((e.charAt(r)<"ぁ"||"ん"<e.charAt(r))&&"ー"!==e.charAt(r)&&" "!==e.charAt(r)&&"　"!==e.charAt(r))return!1;return!0},_isEmailEx:function(e){var r='[^\\s\\(\\)<>@,;:\\\\\\"\\.\\[\\]]+',s=new RegExp("^"+r+"(\\."+r+")*$"),t=e.match(/^(.+)@(.+)$/);if(null===t)return E.messages.MAIL_NO_AT;var n=t[2],a=n.match(/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/);if(null!==a)for(var i=1;i<=4;i++)if(255<a[i])return E.messages.MAIL_INVALID_IP;if(null===n.match(s))return E.messages.MAIL_NO_DOMAIN;var u=new RegExp(r,"g"),l=n.match(u),o=l.length;return l[l.length-1].length<2||4<l[l.length-1].length?E.messages.MAIL_INVALID_LOCALE:o<2?E.messages.MAIL_INVALID_DMAIN:""},format:function(){var e=Array.prototype.slice.call(arguments,0),s=e.shift();return _.each(e,function(e,r){s=s.replace(new RegExp("\\{"+e+"}","g"),r)}),s},join:function(e,r){r===i&&(r="\n");var s=[];return _.each(e,function(e,r){"string"==typeof r&&r?s.push(r):s.push((r.d_name?r.d_name:r.name)+" : "+r.message)}),s.join(r)}};return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void _.error('Method "'+e+'" does not exist in '+s+" plugin!"):t.init.apply(this,arguments)},_.fn[s].defaults={result:null,submit:"validate",confirm_suffix:"_confirm",zip_suffix:"_after",ymd_suffix_y:"_y",ymd_suffix_m:"_m",ymd_suffix_d:"_d",fields:null,errorType:null,clearError:null,setError:null,focusError:!0,focusErrorSpeed:"fast",messages:{VALIDATE_ERROR:"入力に誤りがあります.",REQUIRED:"必須項目です.",REQUIRED_PART:"{0} は必須項目です.",INSUFFICIENT:"不足しています.",INSUFFICIENT_PART:"{0} が不足しています.",CONFIRM:"確認{0}と異なっています.",CONFIRM_FIELD:"項目",NUMERICAL_VALUE:"数字を入力して下さい.",INTEGER:"整数値を入力して下さい.",INTEGER_PART:"{0} は整数値を入力して下さい.",MIN:"{0} ～ の数字を入力してください.",MAX:"～ {0} の数字を入力してください.",RANGE:"{0} ～ {1} の数字を入力してください.",MIN_LENGTH:"{0}文字以上で入力して下さい.",MAX_LENGTH:"{0}文字以下で入力して下さい.",NUM_LENGTH:"{0}桁の数字を入力してください.",CHECKBOX_MIN:"{0} 個チェックしてください.",CHECKBOX_RANGE:"{0}～{1} 個の間でチェックしてください.",ZENKAKU:"全角で入力してください.",HANKAKU:"半角で入力してください.",ZEN_KANA:"全角カタカナで入力してください.",TEL:"数字-()で入力してください.",ZIP:"[nnn-nnnn]書式で記述してください.",DATE:"[YYYY/MM/DD]書式で記述してください.",DATE_EX:"[YYYY/MM/DD] or [YYYY/MM] or [YYYY]書式で記述してください.",DATETIME:"[YYYY/MM/DD hh:mm:ss]書式で記述してください.",TIME:"[hh:mm:ss]書式で記述してください.",TIME_HM:"[hh:mm:ss]書式で記述してください.",DATE_INVALID:"日付が間違っています.",TIME_INVALID:"時間が間違っています.",DATE_PART_Y:"(年)",DATE_PART_M:"(月)",DATE_PART_D:"(日)",REGEXP_INVALID_PARAM:"正規表現が間違っています.",REGEXP_INVALID_VALUE:"書式が間違っています.",MAIL_NO_AT:"正しくありません(@).",MAIL_INVALID_IP:"正しくありません(IP).",MAIL_NO_DOMAIN:"ドメイン名がありません(DOMAIN).",MAIL_INVALID_LOCALE:"正しくありません(LOCALE).",MAIL_INVALID_DMAIN:"ドメイン名の書式が誤っています."}}}(jQuery,window,document);