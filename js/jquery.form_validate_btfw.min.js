/**
 * パラメータチェックプラグイン
 * (TwitterBootstrap3.x対応)
 * v.1.5.2
 * https://github.com/tghkuma/jquery.form_validate_btfw
 */
!function(r){var e="formValidate";r.fn[e]=function(t){var n={result:null,submit:"validate",confirm_suffix:"_confirm",zip_suffix:"_after",fields:null,errorType:null,clearError:null,setError:null,focusError:!0,focusErrorSpeed:"fast",MESSAGE:{VALIDATE_ERROR:"入力に誤りがあります.",REQUIRED:"必須項目です.",NUMERICAL_VALUE:"数字を入力して下さい."}},a={init:function(t){var a=r.extend({},n,t);return this.each(function(){var t=r(this);t.data(e+".settings",a);var n=["submit"];r.each(n,function(){var n=a[this];"string"==typeof n?t.bind(this+"."+e,function(){return t[e](n)}):r.isFunction(n)&&t.bind(this+"."+e,n)})})},dispError:function(t){var n=r(this).data(e+".settings"),i=this;r.each(t,function(r,e){a.setError.apply(i,[e.name,e.message])}),0<t.length&&n.focusError&&a.focusError.apply(this,[t[0].name])},focusError:function(t){var n=r(this).data(e+".settings"),a=r(this).find("*[name='"+t+"']");r(a).focus();var i=r(a).offset().top-r(window).innerHeight()/2;0>i&&(i=0),r("html,body").animate({scrollTop:i},n.focusErrorSpeed)},clearError:function(t){var n=r(this).data(e+".settings");r.isFunction(n.clearError)?n.clearError.apply(this,[t]):"tb2"==n.errorType?a.clearErrorTb2.apply(this,[t]):a.clearErrorBootstrap.apply(this,[t])},setError:function(t,n){var i=r(this).data(e+".settings");r.isFunction(i.setError)?i.setError.apply(this,[t,n]):"tb2"==i.errorType?a.setErrorTb2.apply(this,[t,n]):a.setErrorBootstrap.apply(this,[t,n])},clearErrorBootstrap:function(e){if(e){var t=r(this).find("*[name='"+e+"']");r(t).closest(".form-group").removeClass("has-error").find(".error_message").remove()}else r(this).find(".form-group").removeClass("has-error").find(".error_message").remove()},setErrorBootstrap:function(e,t){var n=r(this).find("*[name='"+e+"']"),a='<span class="help-block error_message">'+t+"</span>";if(r(n).closest(".form-group").addClass("has-error"),"radio"!=n.attr("type")&&"checkbox"!=n.attr("type")){var i=r(n).closest(".input-group");0!=r(i).length?r(i).after(a):r(n).filter(":last").after(a)}else r(n).filter(":last").parent().after(a)},clearErrorTb2:function(e){if(e){var t=r(this).find("*[name='"+e+"']");r(t).closest(".control-group").removeClass("error").find(".error_message").remove()}else r(this).find(".control-group").removeClass("error").find(".error_message").remove()},setErrorTb2:function(e,t){var n=r(this).find("*[name='"+e+"']");r(n).closest(".control-group").addClass("error"),r(n).closest(".controls").append('<div class="help-block error_message">'+t+"</div>")},validate:function(t){var n=r.extend(r(this).data(e+".settings"),t);a.clearError.apply(this);var i=!0,s=a.getValidateResult.apply(this,[n]);return 0<s.length&&(a.dispError.apply(this,[s]),i=!1),r.isFunction(n.result)&&(i=n.result.apply(this,[i,s])),i},validate_alert:function(t){var n=r.extend(r(this).data(e+".settings"),t),i=!0,s=a.getValidateResult.apply(this,[n]);return 0<s.length&&(alert(n.MESSAGE.VALIDATE_ERROR+"\n"+u.join(s)),n.focusError&&a.focusError.apply(this,[s[0].name]),i=!1),r.isFunction(n.result)&&(i=n.result.apply(this,[i,s])),i},getValidateResult:function(t){var n=this,a=r.extend(r(this).data(e+".settings"),t),l=[],o=a.fields;return r.isArray(o)?(r.each(o,function(e,t){if(!t.rules)return!0;var o=t.rules;r.isArray(o)||(o=[o]);var f=r(n).find("*[name='"+t.name+"']"),c=u.existsValue(f);return r.each(o,function(e,o){var p,h,g=[];if(r.isArray(o)){if(!o[0])return;o[1]&&(h=o[1],r.isArray(h)||(h=[h])),o=o[0]}else if("object"==typeof o){if(!o.rule)return;o.params&&(h=o.params,r.isArray(h)||(h=[h])),o=o.rule}else if("string"==typeof o)if(h=o.split(":",2),h[0]&&(o=h[0]),h[1]){try{h=JSON.parse(h[1])}catch(m){h=h[1].split(",")}r.isArray(h)||(h=[h])}else h=[];r.isFunction(o)?(p=o.apply(n,[t,f,h,a]),u.pushErrors(g,t,p)):"string"==typeof o&&(c?s[o]&&(p=s[o].apply(n,[t,f,h,a]),u.pushErrors(g,t,p)):"required"==o?u.pushErrors(g,t,a.MESSAGE.REQUIRED):i[o]&&(p=i[o].apply(n,[t,f,h,a]),u.pushErrors(g,t,p))),g&&0<g.length&&(l=l.concat(g))}),!0}),l):l}},i={zip_ex:function(e,t,n,a){var i=r(this).find("*[name='"+e.name+a.zip_suffix+"']");return!t||!u.getValue(t)||i&&i.val()?null:"不足しています."},ymd:function(e,t,n){var a=[],i=null,s=null,l=null,o=!1,f=!1,c=!1,p=r(this).find("*[name='"+e.name+"_Y']"),h=r(this).find("*[name='"+e.name+"_M']"),g=r(this).find("*[name='"+e.name+"_D']");return p&&""!=p.val()&&(o=!0,i=p.val()),h&&""!=h.val()&&(f=!0,s=h.val()),g&&""!=g.val()&&(c=!0,l=g.val()),"required"==n[0]?(o||a.push("(年) は入力必須項目です."),f||a.push("(月) は入力必須項目です."),c||a.push("(日) は入力必須項目です.")):!(o||f||c)||o&&f&&c||(o||a.push("(年) が不足しています."),f||a.push("(月) が不足しています."),c||a.push("(日) が不足しています.")),u._isInteger(i)||a.push("(年)は整数値を入力して下さい."),u._isInteger(s)||a.push("(月)は整数値を入力して下さい."),u._isInteger(l)||a.push("(日)は整数値を入力して下さい."),0!=a.length||u._isDate(i,s,l)||a.push("日付が間違っています."),a}},s={confirm:function(e,t,n,a){var i=r(this).find("*[name='"+e.name+a.confirm_suffix+"']");return t&&i&&u.getValue(t)==i.val()?null:"確認"+(e.d_name?e.d_name:"項目")+"と異なっています."},email:function(r,e){var t=u.getValue(e);if(t){var n=u._isEmailEx(t);if(""!=n)return n}return null},zenkaku:function(r,e){return u._isZenkaku(u.getValue(e))?null:"全角で入力してください."},hankaku:function(r,e){return u._isHankaku(u.getValue(e))?null:"半角で入力してください."},zen_katakana:function(r,e){return u._isAllkana(u.getValue(e))?null:"全角カタカナで入力してください."},hiragana:function(r,e){return u._isAllHiragana(u.getValue(e))?null:"全角ひらがなで入力してください."},tel:function(r,e){return u._isTel(u.getValue(e))?null:"数字-()で入力してください."},minlength:function(r,e,t){var n=Number(t[0]);return u.getValue(e).length<n?n+"文字以上で入力して下さい.":null},maxlength:function(r,e,t){var n=Number(t[0]);return n<u.getValue(e).length?n+"文字以下で入力して下さい.":null},number:function(e,t,n,a){var i=u.getValue(t);return r.isNumeric(i)&&-1==i.indexOf(" ")?null:a.MESSAGE.NUMERICAL_VALUE},numlength:function(r,e,t){var n=u.getValue(e),a=t[0],i=t[0];t[1]&&(a+=","+t[1],i+="～"+t[1]);var s=new RegExp("^\\d{"+a+"}$");return s.test(n)?null:i+"桁の数字を入力してください."},min:function(r,e,t){var n=u.getValue(e);if(!u._isInteger(n))return"整数値を入力して下さい.";var a=Number(t[0]);return a>n?a+" ～ の数字を入力してください.":null},max:function(r,e,t){var n=u.getValue(e);if(!u._isInteger(n))return"整数値を入力して下さい.";var a=Number(t[0]);return n>a?"～ "+a+" の数字を入力してください.":null},range:function(r,e,t){var n=u.getValue(e);if(!u._isInteger(n))return"整数値を入力して下さい.";var a=Number(t[0]),i=Number(t[1]);return a>n||n>i?a+" ～ "+i+" の数字を入力してください.":null},date:function(r,e){var t=u.getValue(e),n=new RegExp("^((\\d{1,4})[/-](\\d{1,2})[/-](\\d{1,2}))$","g");return t.match(n)?u._isDate(RegExp.$2,RegExp.$3,RegExp.$4)?null:"日付が間違っています.":"[YYYY/MM/DD]書式で記述してください."},datetime:function(r,e){var t=u.getValue(e),n=new RegExp("^((\\d{1,4})[/-](\\d{1,2})[/-](\\d{1,2}))( ((\\d{1,2}):(\\d{1,2})(:(\\d{1,2}))?))?$","g");return t.match(n)?u._isDate(RegExp.$2,RegExp.$3,RegExp.$4)?RegExp.$6&&!u._isTime(RegExp.$7,RegExp.$8,RegExp.$9)?"時間が間違っています.":null:"日付が間違っています.":"[YYYY/MM/DD hh:mm:ss]書式で記述してください."},date_ex:function(r,e){var t=u.getValue(e),n=new RegExp("^(\\d{1,4})([/-](\\d{1,2})([/-](\\d{1,2}))?)?$");if(!t.match(n))return"[YYYY/MM/DD] or [YYYY/MM] or [YYYY]書式で記述してください.";var a=RegExp.$1,i=RegExp.$3?RegExp.$3:1,s=RegExp.$5?RegExp.$5:1;return u._isDate(a,i,s)?null:"日付が間違っています."},time:function(r,e,t){var n,a=u.getValue(e);if("hm"==t[0]){if(n=new RegExp("^(\\d{1,2}):(\\d{1,2})$","g"),!a.match(n))return"[hh:mm]書式で記述してください.";if(!u._isTime(RegExp.$1,RegExp.$2,0))return"時間が間違っています."}else{if(n=new RegExp("^(\\d{1,2}):(\\d{1,2}):(\\d{1,2})$","g"),!a.match(n))return"[hh:mm:ss]書式で記述してください.";if(!u._isTime(RegExp.$1,RegExp.$2,RegExp.$3))return"時間が間違っています."}return null},zip:function(r,e){var t=u.getValue(e),n=new RegExp("^\\d{1,3}-\\d{1,4}$","g");return t.match(n)?null:"[nnn-nnnn]書式で記述してください."},checkbox:function(r,e,t){var n,a=e.filter(":checked").length,i=Number(t[0]);if(2<=t.length){if(n=Number(t[1]),i>a||a>n)return i+"～"+n+" 個の間でチェックしてください."}else if(i>a)return i+" 個チェックしてください."},regexp:function(e,t,n){var a=u.getValue(t);r.isArray(n)||(n=[n]);var i,s;try{if("string"==typeof n[0]?(i=new RegExp(n[0],n[1]?n[1]:void 0),s=n[2]):(i=n[0],s=n[1]),!i.test(a))return s?s:"書式が間違っています."}catch(l){return"正規表現が間違っています."}return null}},u={existsValue:function(r){var e;return e=r?"checkbox"==r.attr("type")?0<r.filter(":checked").length:!!u.getValue(r):!1},getValue:function(e){var t,n=e.attr("type");return"radio"==n?t=e.filter(":checked").val():"checkbox"!=n?t=e.val():(t=[],e.filter(":checked").each(function(){t.push(r(this).val())})),t},pushErrors:function(e,t,n){return"string"==typeof n&&n?e.push({name:t.name,d_name:t.d_name,message:n}):r.isArray(n)&&r.each(n,function(r,n){e.push({name:t.name,d_name:t.d_name,message:n})}),e},_isHankaku:function(r){return!/[^\x20-\x7E]/.test(r)},_isZenkaku:function(r){return!/[\w\-\.]/.test(r)},_isTel:function(r){return!/[^0-9\-\(\)]/.test(r)},_isInteger:function(r){var e=/^(-\d+|\d*)$/.test(""+r);return e&!isNaN(r)},_isDate:function(r,e,t){if(1900>r||r>9999)return!1;if(1>e||e>12)return!1;if(1>t)return!1;var n=[31,28,31,30,31,30,31,31,30,31,30,31];return(r%4==0&&r%100!=0||r%400==0)&&(n[1]=29),!(n[e-1]<t)},_isTime:function(r,e,t){return 0>r||r>=24?!1:0>e||e>=60?!1:!(null!==t&&(0>t||t>=60))},_isAllkana:function(r){for(var e=0;e<r.length;e++)if((r.charAt(e)<"ァ"||r.charAt(e)>"ヶ")&&"ー"!=r.charAt(e)&&" "!=r.charAt(e)&&"　"!=r.charAt(e))return!1;return!0},_isAllHiragana:function(r){for(var e=0;e<r.length;e++)if((r.charAt(e)<"ぁ"||r.charAt(e)>"ん")&&"ー"!=r.charAt(e)&&" "!=r.charAt(e)&&"　"!=r.charAt(e))return!1;return!0},_isEmailEx:function(r){var e=/^(.+)@(.+)$/,t='\\(\\)<>@,;:\\\\\\"\\.\\[\\]',n="[^\\s"+t+"]",a=/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/,i=n+"+",s=new RegExp("^"+i+"(\\."+i+")*$"),u=r.match(e);if(null==u)return"正しくありません(@).";var l=u[2],o=l.match(a);if(null!=o)for(var f=1;4>=f;f++)if(o[f]>255)return"正しくありません(IP).";var c=l.match(s);if(null==c)return"ドメイン名がありません(DOMAIN).";var p=new RegExp(i,"g"),h=l.match(p),g=h.length;return h[h.length-1].length<2||4<h[h.length-1].length?"正しくありません(LOCALE).":2>g?"ドメイン名の書式が誤っています.":""},join:function(e,t){void 0==t&&(t="\n");var n=[];return r.each(e,function(r,e){"string"==typeof e&&e?n.push(e):n.push((e.d_name?e.d_name:e.name)+" : "+e.message)}),n.join(t)}};return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?(r.error('Method "'+t+'" does not exist in '+e+" plugin!"),!0):a.init.apply(this,arguments)}}(jQuery);